# Технічне Завдання Play Vision

## Вступ та базовий функціонал

### 1. Вікно реєстрації
Вікно для створення акаунту через email, телефон або соцмережі. Відкривається після натискання "Реєстрація".

**Поля**:
- email або номер телефона
- пароль (мін. 8 символів)
- згода на оферту/політику та розсилку (необов'язково)
- соцлогіни: Google, Telegram, TikTok
- кнопка "Реєстрація"
- віджет бота/зв'язку

### 2. Вікно входу (авторизація)
**Поля**:
- email або номер телефона
- пароль
- кнопка "Вхід"
- соцлогіни: Google, Telegram, TikTok
- "Відновлення паролю" → email/номер → код з SMS/листа → новий пароль
- кнопка "Відновити"
- віджет бота/зв'язку

### 3. Хедер сторінки
**Ліворуч**: лого + назва
**Посередині**: "Головна", "Про Play Vision", "Хаб знань" (виділено), "Івенти", "Ментор-коучинг", "Підписка" (виділено)
**Праворуч**: "Кабінет", "Кошик", "Вхід"/"Реєстрація"

P.S. Кнопки "Вхід"/"Реєстрація" і "Кошик" взаємовиключні залежно від статусу авторизації.

### 4. Головна сторінка
**Секції**:
1. **Hero-карусель (4 слайди)** — промо-інформація, актуальне з життя компанії
2. **Курси та освітні програми** — галерея 6 курсів (горизонтальний слайдер, видимі по 3), CTA "Огляд курсу"
3. **Календар івентів** — місячна стрічка дат
4. **Ментор-коучінг** — лаконічний опис напрямку з ілюстрацією
5. **Обличчя компанії** — 4 картки авторитетних фахівців
6. **CTA "Доєднатись"** — перекидає в особистий кабінет для заповнення анкети

### 5. "Про Play Vision"
Текст від Євгена. Блоки: Місія/Цінності/"Футбольний трикутник" (гравець-тренер-батьки)/Партнери.

### 6. Розділ "Хаб знань"
**Постійний банер**: "Оформи підписку, стань частиною спільноти фахівців!"

**Компоненти**:
1. **Цитати експертів** — карусель з автозміною кожні 10-20с, портрети авторів
2. **Головні матеріали** — 5-7 ключових продуктів, карусель 20с на кожний (обкладинка, назва, опис)
3. **Всі продукти** — мозаїка з ціною, описом, тривалістю, тегами, індикаторами "кому підходить" (гравець, батьки, тренер ЗФП/дитячий, аналітик, психологія, нутриціологія, медіа, менеджер), можливість додати в "Улюблені", позначки: "топ-продажів", "новинка", "для вас", "вічна класика"
4. **Пошук** — за назвою, автором, тегами
5. **Фільтри** — за напрямками, типом матеріалу, рівнем складності, тривалістю
6. **Прев'ю** — відео 20с, PDF/статті 10% з водяним знаком, CTA "Оформити підписку"/"Купити"
7. **Віджет сапорту** — правий нижній кут

### 7. Розділ "Івенти"
**Випадаюче меню** при наведенні:
- Форум футбольних фахівців
- Форум футбольних батьків  
- Стажування в професійних клубах
- Практичні семінари і хакатони
- Воркшопи зі спортивної психології
- Селекційні табори
- Онлайн-теорії і вебінари

**Детальна сторінка**: інформація, минулі івенти, кнопка "КУПИТИ КВИТОК"
**Pro-Vision підписка**: баланс квитків, статус-бар вибору івенту

### 8. Розділ "Ментор-коучінг"
Текст від Євгена. Секції: Ігровий інтелект • Фізика • Техніка • Ментальність • Життя і побут • Здоров'я.

### 9. Особистий кабінет
**Розділи**:
1. **Профіль** — ФІО, ДН, професія, методи входу, пароль, верифікація, аватар, напрямки інтересів, заохочення призом за заповнення протягом 5 хв
2. **Підписка** — інформація про план (дати, привілеї, статус, вартість), кнопка "Змінити підписку", 4 рівні планів з економією
3. **Історія оплат** — транзакції, кнопка "Повторити" для підписок
4. **Мої файли** — доступні матеріали, індикатор купівлі, улюблені (зірочка), потенційна кнопка скачування, прогрес перегляду
5. **Програма лояльності** — рівень, прогрес-бар балів, знижки

### 10. Розділ "Підписка"
**Сітка планів**: 4 картки (Місяць, 3 міс, 6 міс, 12 міс)
**Інформація**: ціна, термін, бенефіти, бейджі, економія %
**Форма оформлення**: план, промокод, спосіб оплати (картка/Apple Pay/Google Pay)
**Обробка**: успіх/помилка, автопролонгація, скасування
**Система списань**: відразу або частинами

### 11. Кошик  
Праворуч на сторінці, анімація формування, блок "Ідеальний додаток до кошика" (1-2 рекомендації), промокод з валідацією, логіка добору за категоріями.

## Карта вставок зображень

1. **OUR COURSES** → Головна/Хаб знань, 16:9 desktop/4:5 mobile
2. **Календар подій** → Головна/Івенти, 21:9/3:2 mobile  
3. **Гексагональна схема цінностей** → Про Play Vision, 3:2
4. **Mega-menu приклад** → Хедер Івенти (референс)
5. **Картки експертів** → Головна/Партнери, 3:4
6. **Ментор-коучінг мапа** → Головна/Ментор-коучінг, 4:3
7. **Футбольний трикутник** → Про Play Vision, 16:9/4:3 mobile
8. **Іконка Кабінет** → Хедер, SVG 24px@1x/48px@2x
9. **Іконка Кошик** → Хедер, + badge кількості

## Технічні специфікації

### 0. Стек технологій
- **Backend**: Django 5.x, Python 3.12, Postgres 15, Redis, Celery
- **Frontend**: Django Templates + HTML/CSS/JS, progressive enhancement
- **Auth**: OAuth Google, Telegram Login Widget, OTP/пароль
- **Payments**: PCI-DSS шлюз, Apple Pay/Google Pay/3D Secure, рекурентні токени
- **Відео**: HLS + AES-128, підписані URL, динамічний watermark
- **PDF**: вьювер з watermark, заборона скачування
- **PWA**: manifest.json, service worker, offline публічних сторінок
- **Мови**: uk (дефолт), en (готовність)
- **Якість**: CWV (LCP ≤2.5s, CLS ≤0.1, INP ≤200ms), WCAG 2.1 AA
- **Аналітика**: GA4 + Meta Pixel

### 1. Ролі та доступи
- **Гість**: публічні сторінки, прев'ю 20с/10%, кошик → реєстрація при оплаті
- **Користувач**: безкоштовне, разові покупки
- **Підписники L1/L2/L3/L4**: доступ за тегами/entitlements
- **Адмін/Редактор**: керування контентом/подіями/цінами

### 2. Сайтмап
Головна • Про Play Vision • Хаб знань • Івенти • Ментор-коучінг • Підписка • FAQ+AI • Блог • Партнери • Контакти • Юридичні • Кабінет • Кошик • Чекаут

### 3. Навігація та маршрути
**Desktop**: лого, меню, Кабінет/Кошик/Вхід
**Mobile**: бургер-меню, ікон-бар: Home/Хаб/Івенти/Кошик/Кабінет

**URL-схема**:
- Вхід → /auth/login, Реєстрація → /auth/register
- Кабінет → /account, Кошик → /cart
- Курс → /course/:slug, Івент → /events?date=YYYY-MM-DD
- Підписка → /pricing, Чекаут → /checkout

### 4. Безпека та авторизація
- Rate-limit, reCAPTCHA v3, email/phone verification, 2FA опційно
- HTTPS+HSTS, CSP nonce, CSRF/XSS/SQLi захист
- Резервні копії щоденно

### 5. Чекаут та платежі
**Кроки**: 1) Склад, 2) Спосіб оплати, 3) Підтвердження
**Поля**: email/ПІБ, згода з офертою
**3DS**: редірект/iframe challenge, вебхуки Success/Fail
**Рекурент**: токени, керування в Кабінеті
**Події**: begin_checkout, add_payment_info, purchase/subscribe

### 6. Контент-захист
- **Відео**: HLS(AES-128), підписані TTL 60-300с URL, watermark (email+userID+timecode), anti-embed
- **PDF**: вьювер з watermark, прев'ю 10%, заборона копіювання
- **Gating**: blur+замочок без доступу, CTA на покупку

### 7. PWA
- manifest.json (standalone, іконки 192/512)
- Service Worker: Cache-First статика, Network-First контент, no-cache приватне
- iOS meta-теги, splash-екрани, offline-fallback публічних сторінок

### 8. AI-помічник
- Віджети: FAQ/Хаб/Кабінет
- Ролі: гостю — відкриті, підписнику — закриті FAQ за планом
- База знань: позначені "Дозволено AI" матеріали
- Логування запитів, рейтинг відповідей

### 9. Адмін-панель (CMS)
**Модулі**:
- Матеріали/Курси: CRUD, теги, ціни, "Головний матеріал"
- Івенти: квоти, спікери, QR-чек-ін, .csv експорт
- Плани: ціни, бенефіти, баланс квитків
- Купони/Акції: знижки, ліміти
- Користувачі/Ролі: доступи, блокування
- Лояльність: пороги, відсотки
- AI-База знань: FAQ, позначки
- SEO: мета-теги, sitemap
- PWA: кольори, іконки
- Звіти: продажі/конверсії/ARPPU

### 10. SEO/Аналітика
- sitemap.xml, robots.txt, OG cards, schema.org (Course, Event, Article)
- GA4/Meta Pixel події: view_item, add_to_cart, purchase, subscribe, ticket_purchase
- Alt-тексти, контраст ≥4.5:1, таб-навігація, reduced-motion

### 11. Дані/моделі
User, Profile, Role, Plan, Subscription, Entitlement, Product, Material, Tag, Event, Ticket, Order, Payment, Cart, Favorite, Progress, Coupon, LoyaltyLedger, AILog, WebhookEvent

### 12. Емейли/SMS
Верифікація, відновлення паролю, підтвердження покупки, активація підписки, нагадування івентів (24г/1г), списання, промо

### 13. Розподіл на етапи
**Етап 1**: хедер, Головна, Про, Контакти, базова CMS, PWA basic
**Етап 2**: Хаб (пошук/фільтри), Івенти, Кошик, Чекаут, 3DS, адмінка основна, GA4/Pixel  
**Етап 3**: Кабінет повний, HLS+watermark, AI-помічник, баланс квитків, PWA розширений, безпека/тести

## Розширені функції та доповнення

### A. Pixel Manager в адмінці
**Мета**: керування аналітикою без розробника

**Функції**:
- Джерела: GA4, Meta Pixel, TikTok Pixel, GTM, Server-Side (CAPI/MP)
- Налаштування: enabled/disabled, environment, tokens, domain allowlist
- Consent-категорії: analytics/marketing/functional
- Події: стандартні + paywall-специфічні (impression, preview_end, cta_clicks, unlock_success)
- Server-Side дублювання конверсій
- Тест-режим: DebugView, Pixel Helper

### B. Paywall-блоки з замком
**Модель GatedBlock**:
- Поля: title, slug, placement, preview_type, access rules, theme, CTA set
- UI-стани: locked (blur+🔒), preview (20с/10%), unlocked
- Кнопки: Оформити підписку → /pricing, Купити → /checkout, Увійти → /auth/login
- Безпека: серверна перевірка entitlement, SW не кешує приватне

### C. Технічна сумісність
- **PWA × Платежі**: 3DS iframe виключені зі SW, Apple Pay fallback через Safari на iOS
- **PWA × HLS**: SW не кешує m3u8/keys, короткий TTL
- **Pixels × CSP**: nonce скрипти, consent-gate
- **AI × Paywall**: відповіді в межах прав доступу

### D. Специфікація подій для пікселів

| Подія | Тригер | Параметри |
|-------|--------|-----------|
| paywall_impression | блок у viewport locked | paywall_id, item_id, item_type |
| paywall_preview_end | кінець 20с/10% | item_id, item_type |
| paywall_cta_subscribe_click | клік "Оформити підписку" | paywall_id, plan_suggested |
| paywall_cta_buy_click | клік "Купити" | item_id, price |
| add_to_cart | додавання в кошик | item_id, item_type, price |
| begin_checkout | відкрито чекаут | value, currency, items[] |
| purchase/subscribe | успішна оплата | order_id, value, currency |
| ticket_purchase | купівля квитка | event_id, value |

### E. Завдання для розробника
1. Pixel Manager (моделі, UI, CSP-nonce, Consent Mode v2, server-side дублювання)
2. GatedBlock (middleware, UI компоненти, події, модалки)
3. Платежі 3DS + рекурент (токени, вебхуки, state-машина)
4. HLS AES-128 + Signed URLs + watermark overlay
5. PWA (manifest, SW стратегії, iOS fallback)
6. CSP/HSTS конфіг (домени пікселів/платежів/CDN)
7. GA4/Meta/TikTok події (клієнт + сервер)
8. Тести (unit, інтеграційні, E2E paywall→checkout→unlock)
9. Документація (ERD, матриця прав, інструкція для маркетолога)

## Актуальність станом на вересень 2025

### 1. PWA та мобільні платформи
- **iOS 16.4+**: push-повідомлення для PWA після додавання на екран
- **Dark Mode**: адаптація під системні налаштування 
- **iPadOS**: Split View, різні розміри екранів
- **Встановлення**: вручну через "Share → Add to Home Screen"

### 2. Платіжні системи
- **EMV 3-D Secure 2.0**: ризик-орієнтована автентифікація, OTP/біометрія
- **PSD2/SCA в ЄС**: двофакторна автентифікація, винятки для дрібних сум (<€30)

### 3. Безпека (тренди 2025)
- **Zero Trust Architecture**: автентифікація кожного запиту, mTLS
- **Контекстна валідація**: різні правила для HTML/SQL/URL/JS контекстів
- **Адаптивне rate-лімітування**: історія поведінки клієнта
- **SSRF-захист**: allow/block-листи URL, контроль DNS
- **Автосканування залежностей**: npm-audit, OSV-scanner

### 4. AI та етика
- **EU AI Act**: прозорість джерел, обмеження медичних/фінансових порад
- **Персоналізація**: лише за згодою користувача

### 5. Інше
- **Мультимовність**: uk/en для міжнародних партнерів
- **Offline-обмеження**: захищений контент лише стрімінг
- **GDPR**: передавання даних пікселів після згоди на cookies

## Висновок
ТЗ актуальне та готове до розробки у 2025 році з урахуванням всіх сучасних вимог PWA, безпеки, платежів, AI етики та GDPR.