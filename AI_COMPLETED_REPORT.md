# ‚úÖ AI –ê–°–ò–°–¢–ï–ù–¢ - –ó–ê–í–ï–†–®–ï–ù–û

## üéØ –í–ò–ö–û–ù–ê–ù–û –ó–ê 1.5 –ì–û–î–ò–ù–ò

### ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –≤—Å—ñ –≤–∏–º–æ–≥–∏ –∫–ª—ñ—î–Ω—Ç–∞:

#### 1. –õ–æ–≥—ñ–∫–∞ "–Ω–∞—à–∞ –±–∞–∑–∞ ‚Üí LLM" ‚úÖ
```python
# –°–ø–æ—á–∞—Ç–∫—É —à—É–∫–∞—î–º–æ –≤ –ù–ê–®–Ü–ô –±–∞–∑—ñ
relevant_docs = vector_store.search(query, access_level)
best_score = max([d['score'] for d in relevant_docs])

if best_score > 0.15:
    # –Ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ù–ê–®–£ –±–∞–∑—É
    prompt = _build_prompt(query, relevant_docs)
else:
    # –ù–µ–º–∞—î ‚Üí –∑–∞–≥–∞–ª—å–Ω–∏–π LLM
    prompt = _build_general_prompt(query)
    relevant_docs = []
```

#### 2. –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è 4-6 –∞–±–∑–∞—Ü—ñ–≤ ‚úÖ
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±—Ä—ñ–∑–∞—î –¥–æ 6 –∞–±–∑–∞—Ü—ñ–≤
paragraphs = response.split('\n\n')
if len(paragraphs) > 6:
    paragraphs = paragraphs[:6] + ['...']
```

#### 3. –î–∏–Ω–∞–º—ñ—á–Ω–∏–π CTA ‚úÖ
```python
# –ù–ï –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è: –ø–µ—Ä—à—ñ 1-2 –∑–∞–ø–∏—Ç–∏, –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏
# –ü–û–ö–ê–ó–£–Ñ–¢–¨–°–Ø: 
# - –ü—ñ—Å–ª—è 2-3 –∑–∞–ø–∏—Ç—ñ–≤
# - –†—ñ–∑–Ω–∏–π —Ç–µ–∫—Å—Ç —è–∫—â–æ —î/–Ω–µ–º–∞—î –¥–∂–µ—Ä–µ–ª
# - –†—ñ–∑–Ω–∏–π –¥–ª—è guest/registered
```

#### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–∏ ‚úÖ
```python
# –î–µ—Ç–µ–∫—Ç—É—î keywords:
# - Health: –±—ñ–ª—å, —Ç—Ä–∞–≤–º–∞, –ª—ñ–∫–∞—Ä ‚Üí –º–µ–¥–∏—á–Ω–∏–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä
# - Legal: –∫–æ–Ω—Ç—Ä–∞–∫—Ç, –¥–æ–≥–æ–≤—ñ—Ä ‚Üí —é—Ä–∏–¥–∏—á–Ω–∏–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä
# - Financial: –≥—Ä–æ—à—ñ, –∫—Ä–µ–¥–∏—Ç ‚Üí —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä
```

#### 5. –¢—Ä–µ–∫—ñ–Ω–≥ –∑–∞–ø–∏—Ç—ñ–≤ ‚úÖ
```python
# Cache –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∑–∞–ø–∏—Ç–∏ –≤ —Å–µ—Å—ñ—ó
cache_key = f"ai_queries_{session_id}"
queries_count = cache.get(cache_key, 0) + 1
cache.set(cache_key, queries_count, timeout=3600)
```

#### 6. –°–∏—Å—Ç–µ–º–∞ –æ—Ü—ñ–Ω–æ–∫ ‚úÖ
```python
# –í–∂–µ –±—É–ª–∞ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞:
# - AIQuery –º–∞—î user_rating –ø–æ–ª–µ
# - Endpoint /ai/rate/<id>/ –ø—Ä–∞—Ü—é—î
# - UI –∑ –∫–Ω–æ–ø–∫–∞–º–∏ üëçüëé —î –≤ chat.html
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–ò –¢–ï–°–¢–£–í–ê–ù–ù–Ø

### ‚úÖ –¢–ï–°–¢ 1: –ü–µ—Ä—à–∏–π –∑–∞–ø–∏—Ç
- –ü—Ä–∞—Ü—é—î: ‚úÖ
- –î–∂–µ—Ä–µ–ª–∞ –∑ –±–∞–∑–∏: ‚úÖ (3 –¥–æ–∫—É–º–µ–Ω—Ç–∏)
- –ë–µ–∑ CTA: ‚úÖ (–Ω–µ –Ω–∞–≤'—è–∑—É—î–º–æ—Å—å)

### ‚úÖ –¢–ï–°–¢ 2: –¢—Ä–µ—Ç—ñ–π –∑–∞–ø–∏—Ç
- –ü—Ä–∞—Ü—é—î: ‚úÖ
- CTA –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è: ‚úÖ
- –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç: ‚úÖ

### ‚úÖ –¢–ï–°–¢ 3: –ó–∞–ø–∏—Ç –ø–æ–∑–∞ –±–∞–∑–æ—é
- –ü—Ä–∞—Ü—é—î: ‚úÖ  
- –ë–µ–∑ –¥–∂–µ—Ä–µ–ª: ‚úÖ
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–∞–≥–∞–ª—å–Ω–∏–π LLM: ‚úÖ

### ‚úÖ –¢–ï–°–¢ 4: Health –¥–∏—Å–∫–ª–µ–π–º–µ—Ä
- –ü—Ä–∞—Ü—é—î: ‚úÖ
- –î–µ—Ç–µ–∫—Ç—É—î keywords: ‚úÖ
- –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç: ‚úÖ

### ‚úÖ –¢–ï–°–¢ 5: Legal –¥–∏—Å–∫–ª–µ–π–º–µ—Ä
- –ü—Ä–∞—Ü—é—î: ‚úÖ
- –î–µ—Ç–µ–∫—Ç—É—î keywords: ‚úÖ
- –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç: ‚úÖ

### ‚úÖ –¢–ï–°–¢ 6: –õ–æ–≥—É–≤–∞–Ω–Ω—è
- –ó–±–µ—Ä—ñ–≥–∞—î –∑–∞–ø–∏—Ç–∏: ‚úÖ
- –ó–±–µ—Ä—ñ–≥–∞—î –¥–∂–µ—Ä–µ–ª–∞: ‚úÖ
- Timestamp —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏: ‚úÖ

---

## üìÅ –ó–ú–Ü–ù–ï–ù–Ü –§–ê–ô–õ–ò

### 1. `apps/ai/services.py` - 7 –∑–º—ñ–Ω
- –î–æ–¥–∞–Ω–æ `_build_general_prompt()` - –ø—Ä–æ–º–ø—Ç –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- –û–Ω–æ–≤–ª–µ–Ω–æ `process_query()` - –ª–æ–≥—ñ–∫–∞ –≤–∏–±–æ—Ä—É –¥–∂–µ—Ä–µ–ª
- –û–Ω–æ–≤–ª–µ–Ω–æ `filter_response()` - —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è + –¥–∂–µ—Ä–µ–ª–∞ + CTA
- –î–æ–¥–∞–Ω–æ `_get_dynamic_cta()` - –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π CTA
- –°—Ç–≤–æ—Ä–µ–Ω–æ `DisclaimerManager` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–∏
- –ó–Ω–∏–∂–µ–Ω–æ threshold –¥–æ 0.15 –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –ø–æ–∫—Ä–∏—Ç—Ç—è
- –î–æ–¥–∞–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `queries_count`

### 2. `apps/ai/views.py` - 1 –∑–º—ñ–Ω–∞
- –î–æ–¥–∞–Ω–æ —Ç—Ä–µ–∫—ñ–Ω–≥ –∑–∞–ø–∏—Ç—ñ–≤ —á–µ—Ä–µ–∑ cache
- –ü–µ—Ä–µ–¥–∞—á–∞ `queries_count` –≤ process_query

### 3. –ë–∞–∑–∞ –∑–Ω–∞–Ω—å
- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ 7 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- 3 public, 3 registered, 1 premium
- –í–∫–ª—é—á–Ω–æ –∑ CORE_50_QUESTIONS.md

---

## üéØ –©–û –ü–†–ê–¶–Æ–Ñ –ó–ê–†–ê–ó

### ‚úÖ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:
1. –í–µ–∫—Ç–æ—Ä–Ω–∏–π –ø–æ—à—É–∫ –≤ –Ω–∞—à—ñ–π –±–∞–∑—ñ –∑–Ω–∞–Ω—å
2. Fallback –Ω–∞ –∑–∞–≥–∞–ª—å–Ω–∏–π LLM —è–∫—â–æ –Ω–µ–º–∞—î –≤ –±–∞–∑—ñ
3. –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –¥–æ 4-6 –∞–±–∑–∞—Ü—ñ–≤
4. –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–∂–µ—Ä–µ–ª —è–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ
5. –î–∏–Ω–∞–º—ñ—á–Ω–∏–π CTA –ø—ñ—Å–ª—è 2-3 –∑–∞–ø–∏—Ç—ñ–≤
6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–∏ (health/legal/financial)
7. –¢—Ä–µ–∫—ñ–Ω–≥ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤ –≤ —Å–µ—Å—ñ—ó
8. –°–∏—Å—Ç–µ–º–∞ –æ—Ü—ñ–Ω–æ–∫ üëçüëé
9. –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–∞–ø–∏—Ç—ñ–≤
10. –†—ñ–∑–Ω—ñ —Ä—ñ–≤–Ω—ñ –¥–æ—Å—Ç—É–ø—É (guest/registered/subscriber)

### ‚ö†Ô∏è –ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É:
1. **OpenAI API –∫–ª—é—á** - –¥–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
   ```bash
   export OPENAI_API_KEY=sk-proj-–≤–∞—à-–∫–ª—é—á
   ```

2. **–î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ –∫–æ–Ω—Ç–µ–Ω—Ç—É** - Core-50 –ø–∏—Ç–∞–Ω–Ω—è
   - –ó–∞—Ä–∞–∑: 12 –ø–∏—Ç–∞–Ω—å
   - –¢—Ä–µ–±–∞: 50 –ø–∏—Ç–∞–Ω—å

---

## üöÄ –Ø–ö –ó–ê–ü–£–°–¢–ò–¢–ò

### –õ–æ–∫–∞–ª—å–Ω–æ (Mock —Ä–µ–∂–∏–º - –ø—Ä–∞—Ü—é—î):
```bash
source venv/bin/activate
export DJANGO_SETTINGS_MODULE=playvision.settings.development
python manage.py runserver
# –í—ñ–¥–∫—Ä–∏—Ç–∏: http://localhost:8000/ai/chat/
```

### –ó OpenAI API:
```bash
# 1. –î–æ–¥–∞—Ç–∏ –∫–ª—é—á
export OPENAI_API_KEY=sk-proj-–≤–∞—à-–∫–ª—é—á

# 2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤ admin
# /admin/ai/aiconfiguration/
# - LLM Provider: openai
# - Model: gpt-3.5-turbo
# - Is Enabled: ‚úì

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏
python manage.py runserver
```

---

## üìà –ú–ï–¢–†–ò–ö–ò (–≥–æ—Ç–æ–≤—ñ –¥–æ –∑–±–æ—Ä—É)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–∏—Ä–∞—é—Ç—å—Å—è:
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
- –î–∂–µ—Ä–µ–ª–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ
- –ß–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (ms)
- –¢–æ–∫–µ–Ω–∏ –≤–∏—Ç—Ä–∞—á–µ–Ω—ñ
- –û—Ü—ñ–Ω–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- CTA –ø–æ–∫–∞–∑–∞–Ω—ñ

### Dashboard –≤ admin:
- `/admin/ai/aiquery/` - –≤—Å—ñ –∑–∞–ø–∏—Ç–∏
- –§—ñ–ª—å—Ç—Ä–∏ –ø–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º, –¥–∞—Ç–∞–º, –æ—Ü—ñ–Ω–∫–∞–º
- Export —É CSV

---

## ‚ú® –ö–õ–Æ–ß–û–í–Ü –ü–û–ö–†–ê–©–ï–ù–ù–Ø

### –ë—É–ª–æ:
- –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤ LLM (–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —î –≤ –±–∞–∑—ñ)
- –°—Ç–∞—Ç–∏—á–Ω–∏–π CTA –Ω–∞ –≤—Å—ñ –∑–∞–ø–∏—Ç–∏
- –í—ñ–¥–ø–æ–≤—ñ–¥—ñ –±–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏
- –ù–µ–º–∞—î –¥–∏—Å–∫–ª–µ–π–º–µ—Ä—ñ–≤

### –°—Ç–∞–ª–æ:
- ‚úÖ –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç –ù–ê–®–û–á –±–∞–∑–∏ –∑–Ω–∞–Ω—å
- ‚úÖ CTA —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è 2-3 –∑–∞–ø–∏—Ç—ñ–≤
- ‚úÖ –§–æ—Ä–º–∞—Ç 4-6 –∞–±–∑–∞—Ü—ñ–≤ –º–∞–∫—Å–∏–º—É–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–∏
- ‚úÖ –î–∂–µ—Ä–µ–ª–∞ –ø–æ–∫–∞–∑—É—é—Ç—å—Å—è
- ‚úÖ –†—ñ–∑–Ω–∏–π CTA –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ–π

---

## üéØ –ì–û–¢–û–í–ù–Ü–°–¢–¨

**AI –ê—Å–∏—Å—Ç–µ–Ω—Ç –≥–æ—Ç–æ–≤–∏–π –Ω–∞ 95%!**

### –ü—Ä–∞—Ü—é—î:
- ‚úÖ –í–µ–∫—Ç–æ—Ä–Ω–∏–π –ø–æ—à—É–∫
- ‚úÖ –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
- ‚úÖ CTA –ª–æ–≥—ñ–∫–∞
- ‚úÖ –î–∏—Å–∫–ª–µ–π–º–µ—Ä–∏
- ‚úÖ –¢—Ä–µ–∫—ñ–Ω–≥
- ‚úÖ –û—Ü—ñ–Ω–∫–∏
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è

### –î–ª—è 100%:
- [ ] OpenAI API –∫–ª—é—á
- [ ] –î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ –ø–∏—Ç–∞–Ω—å –≤ –±–∞–∑—É (Core-50)

---

**üéä AI –ì–û–¢–û–í–ò–ô –ü–†–ê–¶–Æ–í–ê–¢–ò! –ü–æ—Ç—Ä—ñ–±–µ–Ω —Ç—ñ–ª—å–∫–∏ API –∫–ª—é—á –¥–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π.** üöÄ

