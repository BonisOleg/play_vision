{% extends 'base/base.html' %}
{% load static %}

{% block title %}{{ event.title }} - Play Vision{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/section-base.css' %}">
<link rel="stylesheet" href="{% static 'css/components/unified-sections.css' %}">
<link rel="stylesheet" href="{% static 'css/components/events.css' %}">
{% endblock %}

{% block content %}
<div class="fullscreen-container">
    <div class="unified-sections-wrapper">
        <div class="unified-sections-container">

            <section class="fullscreen-section event-detail-section">
                <div class="section-content">
                    <div class="event-detail-layout">
                        <div class="event-detail-main">
                            <div class="event-detail-header">
                                <span class="event-type">{{ event.get_event_type_display }}</span>
                                <h1 class="event-detail-title">{{ event.title }}</h1>
                                <p class="event-detail-subtitle">{{ event.short_description }}</p>
                            </div>

                            <div class="event-detail-meta">
                                <div class="meta-item">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                        <line x1="16" y1="2" x2="16" y2="6"/>
                                        <line x1="8" y1="2" x2="8" y2="6"/>
                                        <line x1="3" y1="10" x2="21" y2="10"/>
                                    </svg>
                                    <span>{{ event.start_datetime|date:"d F Y, H:i" }}</span>
                                </div>
                                <div class="meta-item">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                        <circle cx="12" cy="10" r="3"/>
                                    </svg>
                                    <span>{% if event.is_online %}Онлайн{% else %}{{ event.location }}{% endif %}</span>
                                </div>
                            </div>

                            <div class="event-detail-description">
                                <h2>Про подію</h2>
                                {{ event.description|linebreaks }}
                            </div>

                            {% if event.speakers.all %}
                            <div class="event-speakers">
                                <h2>Спікери</h2>
                                <div class="speakers-grid">
                                    {% for speaker in event.speakers.all %}
                                    <div class="speaker-card">
                                        <div class="speaker-photo">
                                            {% if speaker.photo %}
                                            <img src="{{ speaker.photo.url }}" alt="{{ speaker.full_name }}">
                                            {% else %}
                                            <div class="speaker-placeholder"></div>
                                            {% endif %}
                                        </div>
                                        <div class="speaker-info">
                                            <h3>{{ speaker.full_name }}</h3>
                                            <p>{{ speaker.position }}</p>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}
                        </div>

                        <aside class="event-detail-sidebar">
                            <div class="event-registration-card">
                                {% if event.is_free %}
                                <div class="event-price">Безкоштовно</div>
                                {% else %}
                                <div class="event-price">{{ event.price }} ₴</div>
                                {% endif %}

                                {% if user.is_authenticated %}
                                    {% if user_ticket %}
                                    <div class="registration-status success">
                                        <p>Ви зареєстровані!</p>
                                    </div>
                                    {% elif can_register %}
                                    <a href="{% url 'events:register' event.slug %}" class="btn-register">
                                        {% if event.is_free %}Зареєструватися{% else %}Купити квиток{% endif %}
                                    </a>
                                    {% else %}
                                    <div class="registration-status warning">
                                        <p>{{ register_message }}</p>
                                    </div>
                                    {% endif %}
                                {% else %}
                                <a href="{% url 'accounts:login' %}?next={{ request.path }}" class="btn-register">
                                    Увійти для реєстрації
                                </a>
                                {% endif %}

                                <div class="event-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Місць:</span>
                                        <span class="stat-value">{{ event.tickets_sold }} / {{ event.max_attendees }}</span>
                                    </div>
                                </div>
                            </div>
                        </aside>
                    </div>
                </div>
            </section>

        </div>
    </div>
</div>
{% endblock %}

