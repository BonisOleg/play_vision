{% extends 'base/base.html' %}
{% load static %}

{% block title %}Івенти - Play Vision{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/section-base.css' %}">
<link rel="stylesheet" href="{% static 'css/components/unified-sections.css' %}">
<link rel="stylesheet" href="{% static 'css/components/events.css' %}">
{% endblock %}

{% block content %}
<div class="fullscreen-container">
    <div class="unified-sections-wrapper">
        <div class="unified-sections-container">

            <!-- СЕКЦІЯ 1: Івенти Play Vision -->
            {% load cms_tags %}
            {% get_event_grid as event_grid_cells %}
            <section class="fullscreen-section events-intro-section">
                <div class="section-content">
                    <div class="events-intro-layout">
                        <!-- Ліва частина 45% -->
                        <div class="events-intro-left">
                            <h2 class="section-title">Івенти Play Vision</h2>
                            <p class="events-intro-subtitle">Трохи тексту загального про Івенти від PV щось мотиваційне можливо</p>
                            
                            <div class="events-categories-grid">
                                <div class="category-block">
                                    <h3>Вебінари</h3>
                                    <p>Проведено 4 великих конференції</p>
                                </div>
                                <div class="category-block">
                                    <h3>Стажування</h3>
                                    <p>Проведено 13 стажувань в клубах УПЛ та ПВПЛ</p>
                                </div>
                                <div class="category-block">
                                    <h3>Семінари</h3>
                                    <p>Важливо дізнати текст про семінари</p>
                                </div>
                                <div class="category-block">
                                    <h3>Форуми</h3>
                                    <p>Проведено 10+ з українськими 18 європейськими експертами</p>
                                </div>
                            </div>
                        </div>

                        <!-- Права частина 55% -->
                        <div class="events-intro-right">
                            <div class="events-video-grid">
                                {% if event_grid_cells %}
                                {% for cell in event_grid_cells %}
                                <div class="video-placeholder {% if cell.position in '1,6,7' %}video-large{% else %}video-medium{% endif %}">
                                    {% if cell.image %}
                                    <img src="{{ cell.image.url }}" alt="{{ cell.alt_text|default:'Event' }}" loading="lazy">
                                    {% else %}
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                    {% endif %}
                                </div>
                                {% endfor %}
                                {% else %}
                                <!-- Fallback якщо немає CMS даних -->
                                <div class="video-placeholder video-large">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-medium">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-medium">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-medium">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-medium">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-large">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-large">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-medium">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="video-placeholder video-medium">
                                    <button class="play-button" aria-label="Відтворити відео">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8 5v14l11-7z"/>
                                        </svg>
                                    </button>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- СЕКЦІЯ 2: Календар подій -->
            <section class="fullscreen-section events-calendar-section">
                <div class="section-content">
                    <h2 class="section-title">Календар подій</h2>
                    
                    <div class="calendar-carousel-wrapper">
                        <div class="calendar-carousel-container">
                            <div class="calendar-carousel-track">
                                {% for day in calendar_days %}
                                <div class="calendar-card">
                                    <div class="calendar-card-header">
                                        <div class="calendar-event-name">/// {% if day.event %}{{ day.event.title }}{% else %}Назва Івенту{% endif %}</div>
                                        <div class="calendar-event-date">{{ day.date|date:"d.m.Y" }}</div>
                                    </div>
                                    <p class="calendar-event-description">
                                        {% if day.event %}{{ day.event.short_description|truncatewords:15 }}{% else %}Опис майбутньої події. Детальна інформація буде доступна найближчим часом.{% endif %}
                                    </p>
                                    <a href="{% if day.event %}{% url 'events:event_detail' day.event.slug %}{% else %}#{% endif %}" class="btn-details">
                                        <span class="btn-text">Детальніше</span>
                                        <span class="btn-arrow"></span>
                                    </a>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <div class="calendar-navigation">
                            <button class="calendar-nav-btn calendar-nav-prev" aria-label="Попередні події">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 18l-6-6 6-6"/>
                                </svg>
                            </button>
                            <button class="calendar-nav-btn calendar-nav-next" aria-label="Наступні події">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="calendar-pagination">
                            <span class="current-page">01</span> /07
                        </div>
                    </div>
                </div>
            </section>

            <!-- СЕКЦІЯ 3: Каталог івентів -->
            <section class="fullscreen-section events-catalog-section">
                <div class="section-content">
                    <h2 class="section-title">Івенти</h2>
                    
                    <div class="event-filters">
                        <a href="{% url 'events:event_list' %}?format=all{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}" 
                           class="filter-btn {% if current_format == 'all' or not current_format %}active{% endif %}">
                            Всі
                        </a>
                        <a href="{% url 'events:event_list' %}?format=online{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}" 
                           class="filter-btn {% if current_format == 'online' %}active{% endif %}">
                            Онлайн
                        </a>
                        <a href="{% url 'events:event_list' %}?format=offline{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}" 
                           class="filter-btn {% if current_format == 'offline' %}active{% endif %}">
                            Офлайн
                        </a>
                    </div>
                    
                    <div class="events-catalog-grid">
                        {% for event in events %}
                        <article class="event-catalog-card" data-type="{% if event.is_online %}online{% else %}offline{% endif %}">
                            <div class="event-card-image">
                                {% if event.thumbnail %}
                                <img src="{{ event.thumbnail.url }}" alt="{{ event.title }}" loading="lazy">
                                {% else %}
                                <div class="event-image-placeholder">
                                    <svg width="60" height="60" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                                    </svg>
                                </div>
                                {% endif %}
                            </div>
                            
                            <div class="event-card-content">
                                <div class="event-card-meta">
                                    <span class="event-type">{{ event.get_event_type_display }}</span>
                                    <span class="event-date">{{ event.start_datetime|date:"d.m.Y" }}</span>
                                </div>
                                
                                <h3 class="event-card-title">{{ event.title }}</h3>
                                <p class="event-card-description">{{ event.short_description|truncatewords:20 }}</p>
                                
                                <div class="event-card-footer">
                                    <span class="event-price">{% if event.is_free %}Безкоштовно{% else %}{{ event.price }} uah{% endif %}</span>
                                    <a href="{% url 'events:event_detail' event.slug %}" class="btn-details">
                                        <span class="btn-text">детальніше</span>
                                        <span class="btn-arrow"></span>
                                    </a>
                                </div>
                            </div>
                        </article>
                        {% empty %}
                        <div class="no-events">
                            <p>Наразі немає доступних подій</p>
                        </div>
                        {% endfor %}
                    </div>
                    
                    {% if is_paginated %}
                    <nav class="pagination">
                        {% if page_obj.has_previous %}
                        <a href="?page={{ page_obj.previous_page_number }}" class="pagination-link">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 18l-6-6 6-6"/>
                            </svg>
                        </a>
                        {% endif %}
                        
                        <span class="pagination-info">
                            Сторінка {{ page_obj.number }} з {{ page_obj.paginator.num_pages }}
                        </span>
                        
                        {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}" class="pagination-link">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 18l6-6-6-6"/>
                            </svg>
                        </a>
                        {% endif %}
                    </nav>
                    {% endif %}
                </div>
            </section>

        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/events.js' %}" defer></script>
{% endblock %}

