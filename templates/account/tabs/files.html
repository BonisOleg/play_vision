<!-- –í–∫–ª–∞–¥–∫–∞ "–ú–æ—ó —Ñ–∞–π–ª–∏" -->
<div class="files-tab">
    {% if materials %}
    <div class="materials-grid">
        {% for material in materials %}
        <div class="material-card" data-material-id="{{ material.id }}">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–∞—Ç–µ—Ä—ñ–∞–ª—É -->
            <div class="material-header">
                <h4 class="material-title">{{ material.title }}</h4>
                <div class="material-type">{{ material.content_type }}</div>
                <button class="favorite-btn {% if material.is_favorite %}active{% endif %}"
                    onclick="toggleFavorite({{ material.course_id }})">
                    <span class="star-icon">‚òÖ</span>
                </button>
            </div>

            <!-- –ü—Ä–æ–≥—Ä–µ—Å –±–∞—Ä -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: {{ material.progress }}%"></div>
                </div>
                <div class="progress-text">{{ material.progress|floatformat:0 }}%</div>
            </div>

            <!-- –î—ñ—ó -->
            <div class="material-actions">
                <button class="btn-action btn-primary" onclick="viewMaterial({{ material.id }})">
                    –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
                </button>

                {% if material.can_download %}
                <button class="btn-action btn-secondary" onclick="downloadMaterial({{ material.id }})">
                    –í –æ—Ñ–ª–∞–π–Ω
                </button>
                {% else %}
                <button class="btn-action btn-secondary disabled" disabled>
                    –í –æ—Ñ–ª–∞–π–Ω
                </button>
                {% endif %}

                <button class="btn-action btn-outline"
                    onclick="toggleCompleted({{ material.id }}, {{ material.is_completed|yesno:'true,false' }})">
                    {% if material.is_completed %}
                    –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ
                    {% else %}
                    –ü–æ–∑–Ω–∞—á–∏—Ç–∏
                    {% endif %}
                </button>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="files-stats">
        <div class="stat-item">
            <span class="stat-number">{{ files_stats.total_materials }}</span>
            <span class="stat-label">–í—Å—å–æ–≥–æ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">{{ files_stats.completed_materials }}</span>
            <span class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">{{ files_stats.in_progress_materials }}</span>
            <span class="stat-label">–í –ø—Ä–æ—Ü–µ—Å—ñ</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">{{ files_stats.favorite_courses }}</span>
            <span class="stat-label">–£–ª—é–±–ª–µ–Ω–∏—Ö</span>
        </div>
    </div>
    {% else %}
    <!-- –ü–æ—Ä–æ–∂–Ω—ñ–π —Å—Ç–∞–Ω -->
    <div class="empty-state">
        <div class="empty-icon">üìÅ</div>
        <h3>–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤</h3>
        {% if not active_subscription %}
        <p>–û—Ñ–æ—Ä–º—ñ—Ç—å –ø—ñ–¥–ø–∏—Å–∫—É –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤</p>
        <a href="{% url 'pricing' %}" class="btn-primary">–û—Ñ–æ—Ä–º–∏—Ç–∏ –ø—ñ–¥–ø–∏—Å–∫—É</a>
        {% else %}
        <p>–ü–æ—á–Ω—ñ—Ç—å –≤–∏–≤—á–∞—Ç–∏ –∫—É—Ä—Å–∏ –≤ –Ω–∞—à–æ–º—É –•–∞–±—ñ –∑–Ω–∞–Ω—å</p>
        <a href="{% url 'content:course_list' %}" class="btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫—É—Ä—Å—ñ–≤</a>
        {% endif %}
    </div>
    {% endif %}
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –º–∞—Ç–µ—Ä—ñ–∞–ª—É -->
<div id="material-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title">–ù–∞–∑–≤–∞ –º–∞—Ç–µ—Ä—ñ–∞–ª—É</h3>
            <button class="modal-close" onclick="closeMaterialModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div id="material-content">
                <!-- –¢—É—Ç –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç –º–∞—Ç–µ—Ä—ñ–∞–ª—É -->
            </div>
        </div>
    </div>
</div>