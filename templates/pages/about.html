{% extends 'base/base.html' %}
{% load static %}
{% load cms_tags %}

{% block title %}Про нас - Play Vision{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/section-base.css' %}">
<link rel="stylesheet" href="{% static 'css/components/about.css' %}">
<link rel="stylesheet" href="{% static 'css/components/unified-sections.css' %}">
<link rel="stylesheet" href="{% static 'css/components/expert-cards-base.css' %}">
<link rel="stylesheet" href="{% static 'css/components/expert-flip-cards.css' %}">
<link rel="preload" href="{% static 'images/Hiro.png' %}" as="image">
<link rel="preconnect" href="https://iframe.mediadelivery.net">
<link rel="dns-prefetch" href="https://iframe.mediadelivery.net">
{% endblock %}

{% block content %}
{% get_about_hero as about_hero %}
<div class="fullscreen-container">

    <!-- 1. HERO SECTION - BunnyNet Video Player -->
    {% if about_hero and about_hero.video_enabled and about_hero|has_video:country_code %}
    <section class="about-hero-section">
        <div style="position: relative; padding-top: 56.25%;">
            <iframe
                src="https://iframe.mediadelivery.net/embed/{{ about_hero|get_video_library_id:country_code }}/{{ about_hero|get_video_id:country_code }}?autoplay=false&muted=false&preload=true&playsinline=true"
                style="border: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                allow="accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;"
                allowfullscreen="true">
            </iframe>
        </div>
    </section>
    {% endif %}

    <!-- UNIFIED SECTIONS WRAPPER -->
    <div class="unified-sections-wrapper">
        <div class="unified-sections-container">

            <!-- 2. УКРАЇНСЬКИЙ ФУТБОЛ -->
            {% get_about_section2 as about_section2 %}
            <section class="fullscreen-section about-triangle-section">
                <div class="section-content">
                    <div class="about-image-block">
                        {% if about_section2 %}
                        {% get_localized_svg about_section2 country_code 'light' as svg_light %}
                        {% get_localized_svg about_section2 country_code 'dark' as svg_dark %}
                        <div class="theme-svg-wrapper">
                            {% if svg_light %}
                            <div class="theme-svg theme-svg--light">{{ svg_light|safe }}</div>
                            {% endif %}
                            {% if svg_dark %}
                            <div class="theme-svg theme-svg--dark">{{ svg_dark|safe }}</div>
                            {% else %}
                                {% if svg_light %}
                                <div class="theme-svg theme-svg--dark">{{ svg_light|safe }}</div>
                                {% endif %}
                            {% endif %}
                        </div>
                        {% else %}
                        <img src="{% static 'images/about1.svg' %}" alt="Український футбол" loading="lazy">
                        {% endif %}
                    </div>
                </div>
            </section>

            <!-- 3. МІСІЯ, ФІЛОСОФІЯ І ВІРА (Grid 3x1) -->
            {% get_about_section3 as about_section3 %}
            <section class="fullscreen-section about-mission-section">
                <div class="section-content">
                    <h2 class="section-title">{% if about_section3 %}{{ about_section3|get_localized_title:country_code }}{% else %}Місія, <span class="text-highlight">філософія</span> і віра{% endif %}</h2>
                    
                    <div class="mission-grid">
                        {% if about_section3 %}
                            {% with svg1_light=about_section3.svg_1_ua_light|default:about_section3.svg_1_world_light svg1_dark=about_section3.svg_1_ua_dark|default:about_section3.svg_1_world_dark %}
                                {% with svg2_light=about_section3.svg_2_ua_light|default:about_section3.svg_2_world_light svg2_dark=about_section3.svg_2_ua_dark|default:about_section3.svg_2_world_dark %}
                                    {% with svg3_light=about_section3.svg_3_ua_light|default:about_section3.svg_3_world_light svg3_dark=about_section3.svg_3_ua_dark|default:about_section3.svg_3_world_dark %}
                                        {% if svg1_light %}
                                        <div class="grid-cell">
                                            <div class="theme-svg-wrapper">
                                                <div class="theme-svg theme-svg--light">{{ svg1_light|safe }}</div>
                                                {% if svg1_dark %}<div class="theme-svg theme-svg--dark">{{ svg1_dark|safe }}</div>{% else %}{{ svg1_light|safe }}{% endif %}
                                            </div>
                                        </div>
                                        {% endif %}
                                        {% if svg2_light %}
                                        <div class="grid-cell">
                                            <div class="theme-svg-wrapper">
                                                <div class="theme-svg theme-svg--light">{{ svg2_light|safe }}</div>
                                                {% if svg2_dark %}<div class="theme-svg theme-svg--dark">{{ svg2_dark|safe }}</div>{% else %}{{ svg2_light|safe }}{% endif %}
                                            </div>
                                        </div>
                                        {% endif %}
                                        {% if svg3_light %}
                                        <div class="grid-cell">
                                            <div class="theme-svg-wrapper">
                                                <div class="theme-svg theme-svg--light">{{ svg3_light|safe }}</div>
                                                {% if svg3_dark %}<div class="theme-svg theme-svg--dark">{{ svg3_dark|safe }}</div>{% else %}{{ svg3_light|safe }}{% endif %}
                                            </div>
                                        </div>
                                        {% endif %}
                                    {% endwith %}
                                {% endwith %}
                            {% endwith %}
                        {% else %}
                            <div class="grid-cell"><img src="{% static 'images/about2.svg' %}" alt="SVG 1" loading="lazy"></div>
                            <div class="grid-cell"><img src="{% static 'images/about2.svg' %}" alt="SVG 2" loading="lazy"></div>
                            <div class="grid-cell"><img src="{% static 'images/about2.svg' %}" alt="SVG 3" loading="lazy"></div>
                        {% endif %}
                    </div>
                </div>
            </section>

            <!-- 4. ЦІННОСТІ ТА КУЛЬТУРА (Grid 3x2) -->
            {% get_about_section4 as about_section4 %}
            <section class="fullscreen-section about-values-section">
                <div class="section-content">
                    <h2 class="section-title">{% if about_section4 %}{{ about_section4|get_localized_title:country_code }}{% else %}Цінності та культура{% endif %}</h2>
                    
                    <div class="values-grid">
                        {% if about_section4 %}
                            {% for i in "123456" %}
                                {% with field="svg_"|add:i|add:"_ua_light" %}
                                    {% with svg_light=about_section4|getattr:field %}
                                        {% if svg_light %}
                                        <div class="grid-cell">
                                            <div class="theme-svg-wrapper">
                                                <div class="theme-svg theme-svg--light">{{ svg_light|safe }}</div>
                                                {% with dark_field="svg_"|add:i|add:"_ua_dark" %}
                                                    {% with svg_dark=about_section4|getattr:dark_field %}
                                                        {% if svg_dark %}<div class="theme-svg theme-svg--dark">{{ svg_dark|safe }}</div>{% else %}{{ svg_light|safe }}{% endif %}
                                                    {% endwith %}
                                                {% endwith %}
                                            </div>
                                        </div>
                                        {% endif %}
                                    {% endwith %}
                                {% endwith %}
                            {% endfor %}
                        {% else %}
                            <div class="grid-cell"><img src="{% static 'images/about3.svg' %}" alt="SVG 1" loading="lazy"></div>
                            <div class="grid-cell"><img src="{% static 'images/about3.svg' %}" alt="SVG 2" loading="lazy"></div>
                            <div class="grid-cell"><img src="{% static 'images/about3.svg' %}" alt="SVG 3" loading="lazy"></div>
                            <div class="grid-cell"><img src="{% static 'images/about3.svg' %}" alt="SVG 4" loading="lazy"></div>
                            <div class="grid-cell"><img src="{% static 'images/about3.svg' %}" alt="SVG 5" loading="lazy"></div>
                            <div class="grid-cell"><img src="{% static 'images/about3.svg' %}" alt="SVG 6" loading="lazy"></div>
                        {% endif %}
                    </div>
                </div>
            </section>

            <!-- 5. КОМАНДА ПРОФЕСІОНАЛІВ -->
            <section class="fullscreen-section experts-section about-team-section">
                <div class="section-content">
                    <div class="experts-header">
                        <h2 class="section-title">Backstage team Play Vision</h2>

                        <div class="experts-navigation">
                            <button class="expert-nav-btn expert-nav-prev" aria-label="Попередні експерти">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 18l-6-6 6-6" />
                                </svg>
                            </button>
                            <button class="expert-nav-btn expert-nav-next" aria-label="Наступні експерти">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 18l6-6-6-6" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <p class="experts-subtitle">Люди, які працюють за бровкою, але без них нічого не існує. Наша команда щоденної дії.</p>

                    <div class="experts-carousel-container">
                        <div class="experts-grid">
                            {% if cms_experts_about %}
                            {% for expert in cms_experts_about %}
                            <div class="expert-card" data-expert-id="{{ forloop.counter }}">
                                <div class="expert-card-inner">
                                    <div class="expert-card-front">
                                        <div class="expert-photo">
                                            {% if expert.photo %}
                                            <img src="{{ expert.photo.url }}" alt="{{ expert.name }}" loading="lazy">
                                            {% else %}
                                            <img src="{% static 'images/prof' %}{{ forloop.counter|default:1 }}.png"
                                                alt="{{ expert.name }}" loading="lazy">
                                            {% endif %}
                                        </div>
                                        <div class="expert-card-content">
                                            <h3 class="expert-name">{{ expert.name }}</h3>
                                            <p class="expert-specialization">{{ expert.specialization|default:expert.position }}</p>
                                            <span class="expert-detail-link">Огляд профілю →</span>
                                        </div>
                                    </div>
                                    <div class="expert-card-back">
                                        <div class="expert-bio-content">
                                            <h3 class="expert-name-back">{{ expert.name }}</h3>
                                            <div class="expert-bio-text">
                                                {% if expert.bio %}
                                                {{ expert.bio|linebreaks }}
                                                {% else %}
                                                <p>Інформація про експерта скоро буде додана.</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                            {% else %}
                            <!-- Немає експертів в БД - показуємо заглушку -->
                            <div class="no-experts-placeholder">
                                <p>Експерти будуть додані найближчим часом</p>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>
    <!-- END UNIFIED SECTIONS WRAPPER -->

</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/about.js' %}" defer></script>
<script src="{% static 'js/expert-flip-cards.js' %}" defer></script>
<script src="{% static 'js/expert-carousel-unified.js' %}" defer></script>
{% endblock %}
