{% extends 'base/base.html' %}
{% load static %}

{% block title %}Хаб Знань - Play Vision{% endblock %}

{% block meta_description %}Освітні програми та матеріали для футбольних фахівців. Курси, книги, відео від провідних
експертів галузі.{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/section-base.css' %}">
<link rel="stylesheet" href="{% static 'css/components/unified-sections.css' %}">
<link rel="stylesheet" href="{% static 'css/components/hub-knowledge.css' %}">
<link rel="stylesheet" href="{% static 'css/components/hub-hero.css' %}">
<link rel="stylesheet" href="{% static 'css/components/hub-carousel.css' %}">
<link rel="stylesheet" href="{% static 'css/components/hub-catalog.css' %}">
{% endblock %}

{% block content %}
<div class="fullscreen-container">
    <div class="unified-sections-wrapper">
        <div class="unified-sections-container">

            <!-- HUB HERO SECTION -->
            <section class="hub-hero-section">
                <div class="hub-hero-grid">

                    <!-- Лівий блок з анімованими написами -->
                    <div class="hub-hero-main">
                        <div class="hub-hero-bg">
                            <img src="{% static 'images/Hiro.png' %}" alt="Хаб знань Play Vision" loading="eager">
                        </div>
                        <div class="hub-hero-content">
                            <div class="hub-hero-logo">
                                <img src="{% static 'images/footerlogowhite.svg' %}" alt="Play Vision" loading="eager">
                            </div>
                            <h1 class="hero-title"></h1>
                            <p class="hero-subtitle"></p>
                            <div class="hero-buttons">
                                <a href="#" class="hub-btn">
                                    <span class="btn-text">Дізнайтися</span>
                                    <span class="btn-logo-space"></span>
                                </a>
                            </div>
                            <div class="hero-slider-dots"></div>
                        </div>
                    </div>

                    <!-- Картка 1 -->
                    <a href="#catalog" class="hub-stat-card hub-stat-card-1">
                        <div class="hub-stat-label">Тематичних</div>
                        <div class="hub-stat-value">20+</div>
                        <div class="hub-stat-desc">Книжок</div>
                    </a>

                    <!-- Картка 2 -->
                    <a href="#catalog" class="hub-stat-card hub-stat-card-2">
                        <div class="hub-stat-label">Ексклюзивних</div>
                        <div class="hub-stat-value">100+</div>
                        <div class="hub-stat-desc">матеріалів</div>
                    </a>

                    <!-- Чорний слоган -->
                    <div class="hub-hero-slogan">
                        <span class="hub-slogan-highlight">Хаб</span> Знань-знання в дії
                    </div>

                    <!-- Картка 3 -->
                    <a href="#catalog" class="hub-stat-card hub-stat-card-3">
                        <div class="hub-stat-label">Годин</div>
                        <div class="hub-stat-value">50+</div>
                        <div class="hub-stat-desc">Відео</div>
                    </a>

                </div>
            </section>

            <!-- Decorative Line -->
            <div class="decorative-line-wrapper">
                <svg width="1300" height="40" viewBox="0 0 1300 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <line class="line-main" x1="1.5" y1="0.975586" x2="1.5" y2="40" stroke-width="3" />
                    <line class="line-main" x1="1298.5" y1="39.0244" x2="1298.5" y2="2.26877e-05" stroke-width="3" />
                    <line class="line-main" x1="2" y1="19.9639" x2="22" y2="19.9639" stroke-width="3" />
                    <line class="line-main" x1="1298" y1="20.0361" x2="1278" y2="20.0361" stroke-width="3" />
                    <line class="line-secondary" x1="22.0352" y1="20.0107" x2="1277.97" y2="20.0107" />
                </svg>
            </div>

            <!-- НАЙКРАЩІ КУРСИ (Featured Carousel) -->
            <section class="hub-featured-section">
                <div class="section-content">
                    <div class="hub-featured-header">
                        <h2 class="section-title">Найкращі</h2>
                        <div class="hub-featured-nav">
                            <button class="hub-nav-btn hub-nav-prev" aria-label="Попередній">
                                <svg width="24" height="24" viewBox="0 0 24 24">
                                    <path d="M15 18l-6-6 6-6" fill="none" stroke="currentColor" stroke-width="2" />
                                </svg>
                            </button>
                            <button class="hub-nav-btn hub-nav-next" aria-label="Наступний">
                                <svg width="24" height="24" viewBox="0 0 24 24">
                                    <path d="M9 18l6-6-6-6" fill="none" stroke="currentColor" stroke-width="2" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="hub-featured-carousel">
                        {% if featured_courses %}
                        {% for course in featured_courses|slice:":1" %}
                        <article class="hub-featured-card">
                            <div class="hub-featured-content">
                                <h3 class="hub-featured-title">{{ course.title }}</h3>
                                <p class="hub-featured-subtitle">{{ course.short_description }}</p>
                                <div class="hub-featured-description">
                                    {{ course.description|truncatewords:50 }}
                                </div>
                                <div class="hub-featured-meta">
                                    Кому підходить:
                                    {% for audience in course.get_target_audience_display|slice:":3" %}
                                    {{ audience }}{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                </div>
                                <div class="hub-featured-divider"></div>
                                <div class="hub-featured-footer">
                                    <a href="{{ course.get_absolute_url }}" class="hub-featured-price">
                                        <span class="price-label">Ціна:</span>
                                        <span class="price-value">{{ course.price }}₴</span>
                                    </a>
                                    <button type="button" class="hub-favorite-btn" data-course-id="{{ course.id }}">
                                        Улюблене
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path
                                                d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="hub-featured-image">
                                {% if course.thumbnail %}
                                <img src="{{ course.thumbnail.url }}" alt="{{ course.title }}" loading="lazy">
                                {% else %}
                                <img src="{% static 'images/placeholder-1200x600.svg' %}" alt="{{ course.title }}"
                                    loading="lazy">
                                {% endif %}
                                <div class="hub-featured-counter">01<span>/{{ featured_courses|length }}</span></div>
                            </div>
                        </article>
                        {% endfor %}
                        {% else %}
                        <div class="hub-no-featured">
                            <p>Найкращі курси скоро з'являться</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </section>

            <!-- Decorative Line -->
            <div class="decorative-line-wrapper">
                <svg width="1300" height="40" viewBox="0 0 1300 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <line class="line-main" x1="1.5" y1="0.975586" x2="1.5" y2="40" stroke-width="3" />
                    <line class="line-main" x1="1298.5" y1="39.0244" x2="1298.5" y2="2.26877e-05" stroke-width="3" />
                    <line class="line-main" x1="2" y1="19.9639" x2="22" y2="19.9639" stroke-width="3" />
                    <line class="line-main" x1="1298" y1="20.0361" x2="1278" y2="20.0361" stroke-width="3" />
                    <line class="line-secondary" x1="22.0352" y1="20.0107" x2="1277.97" y2="20.0107" />
                </svg>
            </div>

            <!-- КАТАЛОГ З ФІЛЬТРАМИ -->
            <section class="hub-catalog-section" id="catalog">
                <div class="section-content">

                    <!-- Layout: Sidebar + Grid -->
                    <div class="hub-catalog-layout">

                        <!-- Ліва колонка: Заголовок + Sidebar -->
                        <div class="hub-filters-column">
                            <h2 class="hub-filters-title">Фільтрувати</h2>
                            <aside class="hub-filters-sidebar">

                                <form method="get" class="hub-filters-form">
                                    <!-- Тематики Dropdown -->
                                    <div class="hub-filter-group">
                                        <button type="button" class="hub-filter-toggle">
                                            Тематики
                                            <span class="hub-filter-arrow">▼</span>
                                        </button>
                                        <div class="hub-filter-content">
                                            {% for category in categories %}
                                            <label class="hub-filter-option">
                                                <input type="radio" name="category" value="{{ category.slug }}" {% if current_category == category.slug %}checked{% endif %}>
                                                <span>{{ category.name }}</span>
                                            </label>
                                            {% endfor %}
                                        </div>
                                    </div>

                                    <!-- Типи контенту Dropdown -->
                                    <div class="hub-filter-group">
                                        <button type="button" class="hub-filter-toggle">
                                            Типи контенту
                                            <span class="hub-filter-arrow">▼</span>
                                        </button>
                                        <div class="hub-filter-content">
                                            <label class="hub-filter-option">
                                                <input type="checkbox" name="content_type" value="video" {% if 'video'
                                                    in current_content_types %}checked{% endif %}>
                                                <span>Відео</span>
                                            </label>
                                            <label class="hub-filter-option">
                                                <input type="checkbox" name="content_type" value="pdf" {% if 'pdf' in
                                                    current_content_types %}checked{% endif %}>
                                                <span>PDF</span>
                                            </label>
                                            <label class="hub-filter-option">
                                                <input type="checkbox" name="content_type" value="article" {%
                                                    if 'article' in current_content_types %}checked{% endif %}>
                                                <span>Стаття</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Чекбокси категорій -->
                                    <div class="hub-filter-checkboxes">
                                        <label
                                            class="hub-filter-checkbox {% if 'coach_youth' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="coach_youth" {%
                                                if 'coach_youth' in current_target_audiences %}checked{% endif %}>
                                            <span>Дитячий тренер</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'coach_fitness' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="coach_fitness" {%
                                                if 'coach_fitness' in current_target_audiences %}checked{% endif %}>
                                            <span>Тренер ЗФП</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'coach' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="coach" {% if 'coach' in
                                                current_target_audiences %}checked{% endif %}>
                                            <span>Тренер професійних команд</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'analyst' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="analyst" {%
                                                if 'analyst' in current_target_audiences %}checked{% endif %}>
                                            <span>Аналітика і скаутинг</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'manager' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="manager" {%
                                                if 'manager' in current_target_audiences %}checked{% endif %}>
                                            <span>Менеджмент</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'psychologist' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="psychologist" {%
                                                if 'psychologist' in current_target_audiences %}checked{% endif %}>
                                            <span>Спортивна психологія</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'nutritionist' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="nutritionist" {%
                                                if 'nutritionist' in current_target_audiences %}checked{% endif %}>
                                            <span>Нутриціологія</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'rehabilitation' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="rehabilitation" {%
                                                if 'rehabilitation' in current_target_audiences %}checked{% endif %}>
                                            <span>Реабілітація</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'media' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="media" {% if 'media' in
                                                current_target_audiences %}checked{% endif%}>
                                            <span>Медіа</span>
                                        </label>
                                        <label
                                            class="hub-filter-checkbox {% if 'parent' in current_target_audiences %}hub-filter-checkbox-active{% endif %}">
                                            <input type="checkbox" name="target_audience" value="parent" {% if 'parent'
                                                in current_target_audiences %}checked{ endif %}>
                                            <span>Батьки</span>
                                        </label>
                                    </div>

                                    <!-- Кнопки дій -->
                                    <div class="hub-filter-actions">
                                        <button type="submit" class="hub-filter-btn hub-filter-btn-primary">
                                            Застосувати
                                        </button>
                                        <button type="button"
                                            class="hub-filter-btn hub-filter-btn-secondary hub-filter-reset">
                                            Відмінити
                                        </button>
                                    </div>
                                </form>
                            </aside>
                        </div>

                        <!-- Права колонка: Пошук + Grid -->
                        <div class="hub-content-column">
                            <!-- Пошук -->
                            <form method="get" action="{% url 'content:course_search' %}" class="hub-search-form">
                                <input type="text" name="q" placeholder="Пошук" class="hub-search-input"
                                    value="{{ request.GET.q }}">
                                <button type="submit" class="hub-search-btn">Знайти</button>
                            </form>

                            <!-- Grid продуктів -->
                            <div class="hub-catalog-grid">
                                {% if courses %}
                                {% for course in courses %}
                                <article class="hub-product-card">
                                    <div class="hub-product-header">
                                        <h3 class="hub-product-title">{{ course.title }}</h3>
                                        <button type="button" class="hub-favorite-icon" data-course-id="{{ course.id }}"
                                            {% if course.id in user_favorites %}data-favorited="true" {% endif %}
                                            aria-label="Додати до улюблених">
                                            <svg class="icon-heart" width="18" height="18" viewBox="0 0 24 24"
                                                fill="none" stroke="currentColor" stroke-width="2">
                                                <path
                                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                                            </svg>
                                        </button>
                                    </div>
                                    <div class="hub-product-image">
                                        {% if course.thumbnail %}
                                        <img src="{{ course.thumbnail.url }}" alt="{{ course.title }}" loading="lazy">
                                        {% else %}
                                        <img src="{% static 'images/placeholder-1200x600.svg' %}"
                                            alt="{{ course.title }}" loading="lazy">
                                        {% endif %}
                                    </div>
                                    <div class="hub-product-body">
                                        <div class="hub-product-price">
                                            <span class="price-label">Ціна:</span>
                                            <span class="price-value">{{ course.price|floatformat:0 }}₴</span>
                                        </div>
                                        <p class="hub-product-desc">{{ course.short_description }}</p>
                                        <div class="hub-product-meta">
                                            Кому підходить:
                                            {% for audience in course.get_target_audience_display|slice:":3" %}
                                            {{ audience }}{% if not forloop.last %}, {% endif %}
                                            {% empty %}
                                            Всім
                                            {% endfor %}
                                        </div>

                                        <a href="{{ course.get_absolute_url }}" class="hub-btn-view">
                                            <span class="btn-text">Огляд курсу</span>
                                            <span class="btn-logo-space"></span>
                                        </a>

                                        {% if course.subscription_tiers and course.subscription_tiers|length > 0 %}
                                        <div class="hub-product-divider"></div>
                                        <div class="hub-product-subscription">
                                            Краще з підпискою:
                                            {% for tier in course.subscription_tiers %}
                                            {{ tier|upper }}{% if not forloop.last %}, {% endif %}
                                            {% endfor %}
                                        </div>
                                        {% elif course.requires_subscription %}
                                        <div class="hub-product-divider"></div>
                                        <div class="hub-product-subscription">
                                            Доступно з підпискою: C-VISION, B-VISION, A-VISION, PRO-VISION
                                        </div>
                                        {% endif %}
                                    </div>
                                </article>
                                {% endfor %}
                                {% else %}
                                <div class="hub-no-products">
                                    <p>Курсів не знайдено</p>
                                    <a href="{% url 'content:course_list' %}" class="btn btn-primary">Показати всі</a>
                                </div>
                                {% endif %}
                            </div>
                        </div>

                    </div>
                </div>
            </section>

        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/hub-knowledge.js' %}" defer></script>
{% endblock %}