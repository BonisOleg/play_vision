{% extends 'base/base.html' %}
{% load static %}

{% block title %}AI –ü–æ–º—ñ—á–Ω–∏–∫ - Play Vision{% endblock %}

{% block meta_description %}–®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç Play Vision - –æ—Ç—Ä–∏–º–∞–π—Ç–µ –º–∏—Ç—Ç—î–≤—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ —Ñ—É—Ç–±–æ–ª, –∫—É—Ä—Å–∏ —Ç–∞
—Ä–æ–∑–≤–∏—Ç–æ–∫ –∫–∞—Ä'—î—Ä–∏.{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/ai-chat.css' %}">
{% endblock %}

{% block content %}
<div class="ai-chat-container">
    <div class="container">
        <!-- Header -->
        <div class="ai-chat-header">
            <div class="ai-avatar">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3" />
                    <path d="M12 1v6m0 6v6" />
                    <path d="m21 12-6-3-6 3-6-3" />
                    <path d="m21 12-6 3-6-3-6 3" />
                    <path d="M12 1l6 3v6l-6 3-6-3V4z" />
                </svg>
            </div>
            <div class="ai-info">
                <h1 class="ai-title">AI –ü–æ–º—ñ—á–Ω–∏–∫ Play Vision</h1>
                <p class="ai-subtitle">–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –µ–∫—Å–ø–µ—Ä—Ç –∑ —Ñ—É—Ç–±–æ–ª—É —Ç–∞ –æ—Å–≤—ñ—Ç–∏</p>
            </div>
        </div>

        {% if not ai_enabled %}
        <div class="ai-maintenance">
            <div class="maintenance-icon">üöß</div>
            <h3>AI –ø–æ–º—ñ—á–Ω–∏–∫ —Ç–∏–º—á–∞—Å–æ–≤–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π</h3>
            <p>{{ maintenance_message|default:"–í–µ–¥—É—Ç—å—Å—è —Ç–µ—Ö–Ω—ñ—á–Ω—ñ —Ä–æ–±–æ—Ç–∏. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ." }}</p>
        </div>
        {% else %}

        <!-- Chat Interface -->
        <div class="ai-chat-interface">
            <!-- Messages Container -->
            <div class="ai-messages" id="ai-messages">
                <div class="ai-message ai-message--bot">
                    <div class="ai-message-avatar">ü§ñ</div>
                    <div class="ai-message-content">
                        <p>–ü—Ä–∏–≤—ñ—Ç! –Ø AI –ø–æ–º—ñ—á–Ω–∏–∫ Play Vision. –ú–æ–∂—É –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏ –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ —Ñ—É—Ç–±–æ–ª, –∫—É—Ä—Å–∏, –ø—ñ–¥–ø–∏—Å–∫–∏ —Ç–∞
                            –±–∞–≥–∞—Ç–æ —ñ–Ω—à–æ–≥–æ. –ü—Ä–æ —â–æ —Ö–æ—á–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è?</p>
                    </div>
                </div>

                <!-- Recent queries for authenticated users -->
                {% if recent_queries %}
                <div class="ai-recent-queries">
                    <h4>–í–∞—à—ñ –æ—Å—Ç–∞–Ω–Ω—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è:</h4>
                    {% for query in recent_queries %}
                    <button class="ai-recent-query" data-query="{{ query.query }}">
                        {{ query.query|truncatechars:60 }}
                    </button>
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <!-- Input Form -->
            <div class="ai-input-container">
                <form class="ai-input-form" id="ai-form">
                    {% csrf_token %}
                    <div class="ai-input-wrapper">
                        <textarea class="ai-input" id="ai-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è..." rows="1"
                            maxlength="500"></textarea>
                        <button type="submit" class="ai-send-btn" id="ai-send" aria-label="–ù–∞–¥—ñ—Å–ª–∞—Ç–∏">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13" />
                                <polygon points="22,2 15,22 11,13 2,9" />
                            </svg>
                        </button>
                    </div>
                    <div class="ai-input-counter">
                        <span id="char-counter">0</span>/500
                    </div>
                </form>
            </div>
        </div>

        <!-- Suggested Questions -->
        <div class="ai-suggestions">
            <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è:</h3>
            <div class="ai-suggestions-grid">
                {% for question in suggested_questions %}
                <button class="ai-suggestion-btn" data-question="{{ question }}">
                    {{ question }}
                </button>
                {% endfor %}
            </div>
        </div>

        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/components/ai-chat.js' %}"></script>
{% endblock %}