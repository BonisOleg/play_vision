{% extends 'base/base.html' %}
{% load static %}

{% block title %}–ü—ñ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞ - Play Vision{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/payment-result.css' %}">
{% endblock %}

{% block content %}
<div class="payment-result-container success">
    <div class="container">
        <div class="result-card">
            <!-- Success Icon -->
            <div class="result-icon success-icon">
                <svg viewBox="0 0 52 52" class="checkmark">
                    <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none" />
                    <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" />
                </svg>
            </div>

            <!-- Success Message -->
            <h1 class="result-title">–í—ñ—Ç–∞—î–º–æ! –ü—ñ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞</h1>

            {% if subscription %}
            <div class="result-details">
                <p class="result-message">
                    –í–∞—à–∞ –ø—ñ–¥–ø–∏—Å–∫–∞ <strong>{{ subscription.plan.name }}</strong> —É—Å–ø—ñ—à–Ω–æ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞
                </p>

                <div class="subscription-info-box">
                    <div class="info-row">
                        <span class="info-label">–ü–ª–∞–Ω:</span>
                        <span class="info-value">{{ subscription.plan.name }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ê–∫—Ç–∏–≤–Ω–∞ –¥–æ:</span>
                        <span class="info-value">{{ subscription.end_date|date:"d.m.Y" }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–í–∞—Ä—Ç—ñ—Å—Ç—å:</span>
                        <span class="info-value">{{ subscription.plan.price }}‚Ç¥</span>
                    </div>
                    {% if subscription.auto_renew %}
                    <div class="info-row highlight">
                        <span class="info-label">–ê–≤—Ç–æ–ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è:</span>
                        <span class="info-value">–£–≤—ñ–º–∫–Ω–µ–Ω–æ</span>
                    </div>
                    {% endif %}
                </div>

                <div class="benefits-preview">
                    <h3>–í–∞—à—ñ –ø–µ—Ä–µ–≤–∞–≥–∏:</h3>
                    <ul>
                        {% for feature in subscription.plan.features %}
                        <li>{{ feature }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endif %}

            <!-- Actions -->
            <div class="result-actions">
                <a href="{% url 'cabinet:subscription' %}" class="btn btn-primary btn-large">
                    –ü–µ—Ä–µ–π—Ç–∏ –≤ –æ—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç
                </a>
                <a href="{% url 'content:course_list' %}" class="btn btn-outline btn-large">
                    –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∫—É—Ä—Å–∏
                </a>
            </div>

            <!-- Auto-redirect notice -->
            <p class="auto-redirect-notice">
                –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ —á–µ—Ä–µ–∑ <span id="countdown">{{ redirect_seconds }}</span> —Å–µ–∫—É–Ω–¥...
            </p>

            <!-- Additional Info -->
            <div class="additional-info">
                <p>üí° –ü—ñ–¥–ø–∏—Å–∫–∞ –ø—Ä–æ–¥–æ–≤–∂—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ. –í–∏ –º–æ–∂–µ—Ç–µ —Å–∫–∞—Å—É–≤–∞—Ç–∏ —ó—ó —É –±—É–¥—å-—è–∫–∏–π –º–æ–º–µ–Ω—Ç –≤ –æ—Å–æ–±–∏—Å—Ç–æ–º—É
                    –∫–∞–±—ñ–Ω–µ—Ç—ñ.</p>
                <p>üìß –î–µ—Ç–∞–ª—ñ –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –Ω–∞ –≤–∞—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–µ–¥—ñ—Ä–µ–∫—Ç
    let countdown = {{ redirect_seconds }};
    const countdownElement = document.getElementById('countdown');
    const redirectUrl = '{{ redirect_url }}';

    const timer = setInterval(function () {
        countdown--;
        countdownElement.textContent = countdown;

        if (countdown <= 0) {
            clearInterval(timer);
            window.location.href = redirectUrl;
        }
    }, 1000);

    // –ê–Ω—ñ–º–∞—Ü—ñ—è –≥–∞–ª–æ—á–∫–∏
    setTimeout(function () {
        document.querySelector('.checkmark').classList.add('animated');
    }, 100);
</script>
{% endblock %}